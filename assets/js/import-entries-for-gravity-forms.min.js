(function(){var a=function(A){const _=document.querySelectorAll(A);if(_.length>1)return _;return _[0]},b=function(B,C,_c,D=!1){document.addEventListener(B,function(_a){_a.target.closest(C)&&(_c.bind(_a),_c.call(_a,_a.target.closest(C)),D&&_a.preventDefault())})},c=function(_A,_b){_A.insertAdjacentHTML('beforeend',_b)},d=async (e,_B=0)=>{if(e.rows.length>0){e.offset=_B;const E=new FormData();E.append('data',JSON.stringify(e));E.append('import_entries_gf_table_data_wpnonce',a('[name="import_entries_gf_table_data_wpnonce"]').value);a('#submit_button_import').style.display='none';const aA=await fetch(ajaxurl+'?action='+a('[name="action_import"]').value,{method:'POST',body:E});const _C=await aA.json();_C.message&&(a('#submit_button_import').style.display='',alert(_C.message));_C.in_progress&&d(e,_C.offset);_C.total_rows_found&&(a('#progress_container').innerHTML=~~_C.offset*100/_C.total_rows_found+'%');_C.is_done&&(a('#please_wait_container').style.display='none',a('#import_is_done').style.display='',a('#submit_button_import').style.display='none',alert(_C.is_done))}};b('click','#submit_button_import',async function(){a('#import_submit_container').style.display='';let aB=a('[name="import_data"]');let aC=JSON.parse(aB.value);let aD=a('#import_form_list_row');aC['fields']={};for(const aE of aD.querySelectorAll('input, select, textarea'))aC['fields'][aE.value]=aE.name;d(aC,1)});b('change','#csv_file',async function(){let aF=a('#submit_button');let aG=a('#csv_file');!aG.files.length?aF.style.display='none':aF.style.display='block'});b('click','#submit_button',async function(){let aH=a('#csv_file');if(!aH.files)return;if(!aH.files.length)return;let aI=a('#import_csv');let aJ=new FormData(aI);var _d=await fetch(ajaxurl+'?action='+aJ.get('action'),{method:'POST',body:aJ});var _e=await _d.json();_e.message&&alert(_e.message);if(_e.rows){var f=_e.rows[0],g=_e.fields;let aK=a('#import_form_list_row');let aL=a('#import_form_list');let aM=a('#import_form_list_item');let _D='';for(let i=0;i<f.length;i++)_D+='<option value="'+i+'" data-if-selected="'+i+'">'+f[i]+'</option>';for(let i=0;i<g.length;i++){let aN=aM.innerHTML;aN=aN.replaceAll('{{fieldId}}',g[i][0]).replaceAll('{{options}}',_D).replace(new RegExp(`data-if-selected="${i}"`, 'g'),'selected').replaceAll('{{rowName}}',g[i][1]);c(aL,aN)}aK.style.display='';a('[name="import_data"]').value=JSON.stringify(_e);a('#start_import_field_container').style.display='';a('#import_field_container').style.display='none'}});b('change','#import_field_container_list',async function(){let aO=a('#import_field_container');let aP=this.target.value;aP!==''?aO.style.display='':aO.style.display='none'})})();
